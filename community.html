<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="community.css">
    <link rel="stylesheet" href="Header.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel = "stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link rel = "stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marko+One&display=swap" rel="stylesheet">
    <title>MovieTime - Community</title>
    <link rel="icon" href="Assets/HeaderPhoto/logo.png">
</head>
<body>
    <header>
        <a href="home.html" class="movielogo"> 
            <img class="logomovie" src="Assets/HeaderPhoto/logo.png">
            <h2>MovieTime</h2>
        </a>
        <nav>
            <ul class="navigation">
                <li class="top"><a href="home.html">Home</a></li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">Category</a>
                    <ul class="dropdown-content">
                        <a href="category.html?genre=Action">Action</a>
                        <a href="category.html?genre=Adventure">Adventure</a>
                        <a href="category.html?genre=Animation">Animation</a>
                        <a href="category.html?genre=Comedy">Comedy</a>
                        <a href="category.html?genre=Drama">Drama</a>
                        <a href="category.html?genre=Fantasy">Fantasy</a>
                        <a href="category.html?genre=Horror">Horror</a>
                        <a href="category.html?genre=Romance">Romance</a>
                        <a href="category.html?genre=Thriller">Thriller</a>
                    </ul>
                </li>
                <li><a href="history.html">History</a></li>
                <li><a href="Watchlist.html">Watchlist</a></li>
                <li><a href="community.html"><p class="page-is-clicked">Community</p></a></li>
            </ul>
        </nav>

        <div class="rightnav">
            <div class="search">
                <form>
                    <input type="text" placeholder="Search..." id="searchInput">
                </form>
                <img src="Assets/HeaderPhoto/search.png" id="searchButton" onclick="goToSearch()">
            </div>

            <div class="profile dropdown">
                <img src="Assets/HeaderPhoto/profileicon.png" class="profil" id="profileIcon">
                <div class="dropdown-profile" id="dropdownMenu">
                    <a href="#" id="logoutLink"><img src="Assets/HeaderPhoto/logout.png" id="logoutIcon"><span class="logout-text">Logout</span></a>
                </div>
            </div>          
            
            <div class="bx bx-menu" id="icon"></div>
        </div>

    </header>
    <div class="community-top">
        <div class="SearchBar">
            <img class="SearchIcon" src="Assets/Icon/black-search.png">
            <input type="text" name="Search-input" id="Search-input" placeholder="Search...">
        </div>
        <div class="Create-thread" onclick="popUpCreate()">
            <p>Create Thread</p>
            <img class="PlusIcon" src="Assets/Icon/white-plus.png">
        </div>
        <div class="trending-Thread">
            <img class="TrendingIcon" src="Assets/Icon/trending.png">
        </div>
    </div>
    <div class="community-bottom">
        <div class="community-thread">
            <div class="threads">
                <div class="Post-thread" id="Post-thread">
                    <img class="Profile-pic" src="Assets/Icon/profilepicture.png">
                    <div class="Input-area">
                        <textarea id="autoresizing" name="" placeholder="Type something..." class="comment-text" oninput="toggleButton()"></textarea>
                        <div class="flex-column">
                            <div id="imagePreviewContainer"></div>
                            <div class="row-input">
                                <div class="Images">
                                    <img id="imageSelector" class="Image-Input" src="Assets/Icon/image.png" onclick="imageUpload()">
                                </div>
                                <div class="Post-button">
                                    <button id="post-button" class="Thread-btn" onclick="postComment()" disabled>Post</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr id="hr-thread">
                <div class="search-Msg" id="search-Msg"></div>
                <div id="posted-comments"></div>
                <!-- <div id="comments-demo">
                    <div class="comment-1">
                        <div class="Thread-list">
                            <img class="Profile-pic" src="Assets/Icon/profilepicture.png">
                            <div class="Thread-information">
                                <p id="Thread-name">Valak Vundak</p>
                                <p id="Thread-time">12:00 - 1 May 2024</p>
                                <p id="Thread-text">Nyesel gua nonton Lumayan Lain,  film ini tuh kayak kencan buta yang awalnya penuh harapan tapi endingnya bikin lo pulang dengan hati hampa. Bukan berarti gue nggak menghargai kerja keras mereka sih, tapi ya, sebagai penonton yang udah rela ngeluarin waktu dan duit, pengennya sih dapat pengalaman nonton yang memorable.
                                    Ah, sudahlah, semoga film-film selanjutnya bisa lebih menggigit dan nggak bikin kita kecewa lagi. Kita butuh cerita yang bukan hanya sekedar tontonan, tapi juga bisa menggerakkan hati dan pikiran. Semangat terus untuk para pembuat film Indonesia! Kita tahu kalian bisa lebih dan lebih lagi!
                                    #LumayanLain
                                </p>
                                <div class="comment-details">
                                    <div class="comment-like-section">
                                        <img src="Assets/Icon/like.png" class="comment-like-icon" alt="">
                                        <p class="comment-like-count">0</p>
                                    </div>
                                    <div class="comment-reply-section" onclick="toggleReplies()">
                                        <img src="Assets/Icon/comment.png" class="comment-reply-icon" alt="">
                                        <p class="comment-reply-count">1</p>
                                    </div>
                                    <p class="reply-comment">Reply</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="reply-a-comment-container">
                        <div class="reply-comment-section">
                          <div class="flex-row">
                            <img src="Assets/Icon/profilepicture.png" alt="">
                            <div class="flex-column">
                                <textarea id="autoresizing" name="" placeholder="Type something..." class="reply-comment-text" oninput="toggleReplyButton()"></textarea>
                                <div id="reply-imagePreviewContainer"></div>
                            </div>
                          </div>
                          <div class="reply-buttons">
                            <div class="Images">
                                <img class="Reply-image-Input" id="imageSelector" src="Assets/Icon/image.png" onclick="replyimageUpload()">
                            </div>
                            <button id="cancel-button" class="cancel-button">Cancel</button>
                            <button id="reply-button" class="reply-button" onclick="replyComment()" disabled>Reply</button>
                          </div>
                        </div>
                    </div>
    
                    <div class="posted-reply-container">
                        <div class="posted-reply-section">
                            <div class="flex-row">
                                <img src="Assets/Icon/profilepicture.png" alt="">
                                <div class="flex-column">
                                    <p class="comment-author">Marvin Kopling Samping</p>
                                    <p class="comment-date">07:24 - 6 May 2024</p>
                                    <p class="comment-description"><span class="replying-to">@Ferlie Ban Dalam</span> The "Invincible" title says it all slowly breaking each episode when he had small good changes. Notice how the title didn't come out in episode 8 because he didn't change.</p>
                                <div class="comment-details">
                                    <div class="comment-like-section">
                                        <img src="Assets/Icon/like.png" class="comment-like-icon" alt="">
                                        <p class="comment-like-count">0</p>
                                    </div>
                                    <div class="comment-reply-section" onclick="toggleReplies()">
                                        <img src="Assets/Icon/comment.png" class="comment-reply-icon" alt="">
                                        <p class="comment-reply-count">0</p>
                                    </div>
                                    <p class="reply-comment">Reply</p>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                <div id="Temporary-comment"></div>
            </div>
        </div>
        <div class="Trending-film" id="Trending-film">
            <div class="Trending-content">
                <p class="Title-trending">#TrendingFilm</p>
                <hr>
                <div class="Trend-1">
                    <p id="Number-1">1.</p>
                    <div class="Trend-info">
                        <p id="Trendtitle-1">#QueenOfTears</p>
                        <p id="Trendthreads-1">2435 threads</p>
                    </div>
                </div>
                <div class="Trend-1">
                    <p id="Number-1">2.</p>
                    <div class="Trend-info">
                        <p id="Trendtitle-1">#GodzillaXKong</p>
                        <p id="Trendthreads-1">2019 threads</p>
                    </div>
                </div>
                <div class="Trend-1">
                    <p id="Number-1">3.</p>
                    <div class="Trend-info">
                        <p id="Trendtitle-1">#Exhuma</p>
                        <p id="Trendthreads-1">1499 threads</p>
                    </div>
                </div>
                <div class="Trend-1">
                    <p id="Number-1">4.</p>
                    <div class="Trend-info">
                        <p id="Trendtitle-1">#GameOfThrones</p>
                        <p id="Trendthreads-1">642 threads</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="popupOverlay-Trending" class="popup-overlay-Trending"></div>
    <div id="popupContent-Trending" class="popup-content-Trending"></div>
    <div id="popupOverlay" class="overlay">
        <div id="popupContent" class="Popup-content">
            <div class="flex-row">
                <p class="popup-Title">What's on your mind?</p>
                <img src="Assets/Icon/letter-x.png" id="Close-popupCreate" onclick="closepopUpCreate()">
            </div>
            <div class="Post-thread">
                <img class="Profile-pic" src="Assets/Icon/profilepicture.png">
                <div class="Input-area">
                    <textarea id="autoresizing" name="" placeholder="Type something..." class="comment-text-popup" oninput="toggleButtonpopup()" oninput="autoResize()"></textarea>
                    <div class="flex-column">
                        <div id="imagePreviewContainer-popup"></div>
                        <div class="row-input">
                            <div class="Images">
                                <img id="imageSelector" class="Image-Input" src="Assets/Icon/image.png" onclick="imageUploadPopup()">
                            </div>
                            <div class="Post-button">
                                <button id="post-button-popup" class="Thread-btn" onclick="postCommentpopup()" disabled>Post</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay-done" id="popupDone">  
        <div class="Popup-done" id="popupMessage">
            <p>Your post has been published</p>
        </div>
    </div>
    <script src="JavaScripts/community.js"></script>
    <script src="JavaScripts/Header.js"></script>
    <script>
        function goToSearch() {
            const searchText = document.getElementById('searchInput').value;
            if(searchText.length > 0){
                window.location.href = 'search.html?search=' + encodeURIComponent(searchText);
                document.getElementById('searchInput').value = "";
            }
        }   

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                goToSearch();
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keypress', handleKeyPress);
        });

        var postedCommentsContainer = document.getElementById('posted-comments');
    
        var comments = [
        {
            name: 'John',
            time: '10:00',
            text: 'Great movie!',
            likecount: 5,
            replycount: 2,
            reply: [
            {
                name: 'Sarah',
                time: '10:05',
                text: 'I agree, it was amazing!',
                likecount: 3,
                replycount: 0,
                reply: [],
                hashtag: 'none'
            },
            {
                name: 'Michael',
                time: '10:10',
                text: 'Epic battle scenes!',
                likecount: 2,
                replycount: 0,
                reply: [],
                hashtag: 'none'
            }
            ],
            hashtag: '#GodzillaXKong'
        },
        {
            name: 'Emma',
            time: '11:30',
            text: 'I loved the character development!',
            likecount: 8,
            replycount: 1,
            reply: [
            {
                name: 'Alex',
                time: '11:35',
                text: 'Yes, it was so well done!',
                likecount: 4,
                replycount: 0,
                reply: [],
                hashtag: 'none'
            }
            ],
            hashtag: '#QueenOfTears'
        },
        {
            name: 'Lisa',
            time: '12:45',
            text: 'Can\'t wait for the next season!',
            likecount: 6,
            replycount: 1,
            reply: [
            {
                name: 'David',
                time: '12:50',
                text: 'Me too! It\'s going to be epic!',
                likecount: 2,
                replycount: 0,
                reply: [],
                hashtag: 'none'
            }
            ],
            hashtag: '#Exhuma'
        },
        {
            name: 'Chris',
            time: '13:15',
            text: 'The storyline was gripping!',
            likecount: 7,
            replycount: 0,
            reply: [],
            hashtag: '#GameOfThrones'
        },
        ];
    
    for (var i = comments.length - 1; i >= 0; i--) {
    var comment = comments[i];

    var commentElement = document.createElement('div');
    commentElement.classList.add('comment-1');
    commentElement.id = 'List-' + i;

    commentElement.innerHTML = `
    <div class="Thread-list ${i}">
        <img class="Profile-pic" src="Assets/Icon/profilepicture.png">
        <div class="Thread-information">
            <p id="Thread-name">${comment.name}</p>
            <p id="Thread-time">${comment.time}</p>
            <p id="Thread-text">${comment.text}</p>
            <div class="comment-details">
                <div class="comment-like-section posted-reply-like-counter">
                    <img src="Assets/Icon/like.png" class="comment-like-icon" alt="">
                    <p class="comment-like-count">${comment.likecount}</p>
                </div>
                <div class="comment-reply-section" onclick="toggleRepliesTag(this)">
                    <img src="Assets/Icon/comment.png" class="comment-reply-icon" alt="">
                    <p class="comment-reply-count">${comment.replycount}</p>
                </div>
                <p class="reply-comment">Reply</p>
            </div>
        </div>
    </div>
    <div class="reply-a-comment-container">
        <div class="reply-comment-section">
            <div class="flex-row">
                <img src="Assets/Icon/profilepicture.png" alt="">
                <div class="flex-column">
                    <textarea id="autoresizing" name="" placeholder="Type something..." class="reply-comment-text" oninput="toggleReplyButton()"></textarea>
                    <div id="reply-imagePreviewContainer"></div>
                </div>
            </div>
            <div class="reply-buttons">
                <div class="Images">
                    <img class="Reply-image-Input" id="imageSelector" src="Assets/Icon/image.png" onclick="replyimageUpload()">
                </div>
                <button id="cancel-button" class="cancel-button">Cancel</button>
                <button id="reply-button" class="reply-button" onclick="replyComment()" disabled>Reply</button>
            </div>
        </div>
    </div>
    `;

    var postedComments = document.getElementById("posted-comments");
    postedComments.insertBefore(commentElement, postedComments.firstChild);

    comment.reply.forEach(reply => {
        var replyElement = document.createElement('div');
        replyElement.classList.add('reply');
        replyElement.style.display = 'none';
        replyElement.innerHTML = `
        <div class="posted-reply-sections">
                  <div class="flex-row">
                      <img src="Assets/Icon/profilepicture.png" alt="">
                      <div class="flex-column">
                          <p class="comment-author">${reply.name}</p>
                          <p class="comment-date">${reply.time}</p>
                          <p class="comment-description">${reply.text}</p>
                          <div class="comment-details">
                              <div class="comment-like-section">
                                  <img src="Assets/Icon/like.png" class="comment-like-icon" alt="">
                                  <p class="comment-like-count">${reply.likecount}</p>
                              </div>
                              <div class="comment-reply-section">
                                  <img src="Assets/Icon/comment.png" class="comment-reply-icon" alt="">
                                  <p class="comment-reply-count">${reply.replycount}</p>
                              </div>
                              <p class="reply-comment">Reply</p>
                          </div>
                      </div>
                  </div>
              
        `;
        commentElement.appendChild(replyElement);
    });

    var likeSection = commentElement.querySelector('.comment-like-section');
    likeSection.addEventListener('click', function() {
        var likeIcon = this.querySelector('.comment-like-icon');
        var likeCount = this.querySelector('.comment-like-count');

        var liked = JSON.parse(likeIcon.getAttribute('data-liked'));

        if (!liked) {
            likeCount.textContent = parseInt(likeCount.textContent) + 1;
            likeIcon.src = 'Assets/Icon/like (1).png';
            likeCount.style.color = '#47B5FF'; 
        } else {
            likeCount.textContent = parseInt(likeCount.textContent) - 1;
            likeIcon.src = 'Assets/Icon/like.png'; 
            likeCount.style.color = '#FFFFFF'; 
        }

        likeIcon.setAttribute('data-liked', !liked);
    });
}

    </script>
</body>
</html>